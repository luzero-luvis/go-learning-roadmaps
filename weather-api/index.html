<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Go Weather API - Step by Step</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', sans-serif; background: #f0f2f5; min-height: 100vh; padding: 20px; }
        .container { max-width: 900px; margin: 0 auto; background: white; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); overflow: hidden; }
        .header { background: linear-gradient(135deg, #00b4db 0%, #0083b0 100%); color: white; padding: 30px; text-align: center; }
        .header h1 { font-size: 2em; margin-bottom: 10px; }
        .header p { opacity: 0.9; }
        .steps { padding: 30px; }
        .step { margin-bottom: 30px; border: 2px solid #e0e0e0; border-radius: 10px; overflow: hidden; }
        .step-header { padding: 20px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; background: #fafafa; transition: background 0.2s; }
        .step-header:hover { background: #f0f0f0; }
        .step.completed .step-header { background: #e8f5e9; border-color: #4caf50; }
        .step.active .step-header { background: #e3f2fd; border-color: #2196f3; }
        .step-num { width: 40px; height: 40px; background: #2196f3; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; margin-right: 15px; }
        .step.completed .step-num { background: #4caf50; }
        .step-title { display: flex; align-items: center; flex: 1; }
        .step-title h3 { font-size: 1.2em; }
        .step-title p { color: #666; font-size: 0.9em; margin-top: 3px; }
        .step-content { padding: 20px; display: none; background: #fff; }
        .step.active .step-content { display: block; }
        .checklist { margin-top: 15px; }
        .check-item { display: flex; align-items: flex-start; gap: 10px; padding: 10px 0; border-bottom: 1px solid #eee; }
        .check-item:last-child { border-bottom: none; }
        .check-item input { width: 20px; height: 20px; cursor: pointer; accent-color: #2196f3; flex-shrink: 0; margin-top: 2px; }
        .check-item label { cursor: pointer; flex: 1; line-height: 1.5; }
        .code-block { background: #1e1e1e; color: #d4d4d4; padding: 15px; border-radius: 8px; overflow-x: auto; font-family: 'Consolas', monospace; font-size: 0.9em; line-height: 1.5; margin: 10px 0; white-space: pre; }
        .code-block .keyword { color: #569cd6; }
        .code-block .string { color: #ce9178; }
        .code-block .comment { color: #6a9955; font-style: italic; }
        .code-block .func { color: #dcdcaa; }
        .code-block .type { color: #4ec9b0; }
        .tip { background: #e8f5e9; border-left: 4px solid #4caf50; padding: 12px 15px; margin: 15px 0; border-radius: 0 8px 8px 0; font-size: 0.95em; }
        .tip strong { color: #2e7d32; }
        .tip a { color: #1b5e20; }
        .info-box { background: #fff3cd; border: 1px solid #ffc107; padding: 15px; border-radius: 8px; margin: 15px 0; }
        .info-box strong { color: #856404; }
        .progress-bar { background: #e0e0e0; height: 8px; border-radius: 4px; margin: 20px 30px 5px; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, #00b4db, #0083b0); width: 0%; transition: width 0.3s; }
        .progress-text { text-align: center; padding: 5px 30px 20px; color: #666; font-size: 0.9em; }
        .nav { display: flex; justify-content: center; gap: 10px; padding: 20px; background: #fafafa; }
        .nav button { padding: 10px 20px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; transition: transform 0.2s; }
        .nav button:hover { transform: translateY(-2px); }
        .nav .reset { background: #f44336; color: white; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Go Weather API - 6 Steps</h1>
            <p>Build a production-ready API from scratch</p>
        </div>
        
        <div class="progress-bar">
            <div class="progress-fill" id="progress"></div>
        </div>
        <div class="progress-text" id="progressText">0% Complete</div>
        
        <div class="steps">
            <!-- Step 1: Setup -->
            <div class="step active" data-step="1">
                <div class="step-header" onclick="toggleStep(1)">
                    <div class="step-title">
                        <div class="step-num">1</div>
                        <div>
                            <h3>Project Setup</h3>
                            <p>Initialize Go project and install dependencies</p>
                        </div>
                    </div>
                </div>
                <div class="step-content">
                    <div class="info-box">
                        <strong>Goal:</strong> Get your project ready with all needed tools
                    </div>
                    
                    <div class="checklist">
                        <div class="check-item">
                            <input type="checkbox" id="step1-1" onchange="updateProgress()">
                            <label for="step1-1">Create project folder and initialize Go module</label>
                        </div>
                        <div class="check-item">
                            <input type="checkbox" id="step1-2" onchange="updateProgress()">
                            <label for="step1-2">Install packages: Gin, Redis, Viper, Tollbooth, Swag</label>
                        </div>
                        <div class="check-item">
                            <input type="checkbox" id="step1-3" onchange="updateProgress()">
                            <label for="step1-3">Create folder structure (cmd, internal/*)</label>
                        </div>
                    </div>
                    
                    <h4 style="margin-top: 20px;">Commands to run:</h4>
                    <div class="code-block">mkdir weather-api
cd weather-api
go mod init weather-api</div>
                    
                    <div class="code-block">go get github.com/gin-gonic/gin
go get github.com/go-redis/redis/v8
go get github.com/spf13/viper
go get github.com/didip/tollbooth
go get github.com/swaggo/gin-swagger@latest
go get github.com/swaggo/swag@latest</div>
                    
                    <div class="code-block">mkdir -p cmd internal/{config,handlers,services,cache,middleware} docs</div>
                    
                    <div class="tip">
                        <strong>Tip:</strong> Keep your terminal open! You'll run commands here throughout the tutorial.
                    </div>
                </div>
            </div>
            
            <!-- Step 2: Configuration -->
            <div class="step" data-step="2">
                <div class="step-header" onclick="toggleStep(2)">
                    <div class="step-title">
                        <div class="step-num">2</div>
                        <div>
                            <h3>Configuration</h3>
                            <p>Set up environment variables and config file</p>
                        </div>
                    </div>
                </div>
                <div class="step-content">
                    <div class="info-box">
                        <strong>Goal:</strong> Store API keys and settings safely outside your code
                    </div>
                    
                    <div class="checklist">
                        <div class="check-item">
                            <input type="checkbox" id="step2-1" onchange="updateProgress()">
                            <label for="step2-1">Create .env file with API key and settings</label>
                        </div>
                        <div class="check-item">
                            <input type="checkbox" id="step2-2" onchange="updateProgress()">
                            <label for="step2-2">Create cmd/config.json</label>
                        </div>
                        <div class="check-item">
                            <input type="checkbox" id="step2-3" onchange="updateProgress()">
                            <label for="step2-3">Write internal/config/config.go</label>
                        </div>
                    </div>
                    
                    <h4 style="margin-top: 20px;">1. Create <span class="code-block" style="display:inline;padding:2px 6px;">.env</span> file:</h4>
                    <div class="code-block">WEATHER_API_KEY=your_api_key_here
REDIS_ADDR=localhost:6379
SERVER_PORT=:8080</div>
                    
                    <h4 style="margin-top: 20px;">2. Create <span class="code-block" style="display:inline;padding:2px 6px;">cmd/config.json</span>:</h4>
                    <div class="code-block">{
    "serverPort": ":8080",
    "weatherApiKey": "",
    "redisAddress": "localhost:6379"
}</div>
                    
                    <h4 style="margin-top: 20px;">3. Create <span class="code-block" style="display:inline;padding:2px 6px;">internal/config/config.go</span>:</h4>
                    <div class="code-block"><span class="keyword">package</span> config

<span class="keyword">import</span> <span class="string">"github.com/spf13/viper"</span>

<span class="keyword">type</span> Config <span class="keyword">struct</span> {
    ServerPort    <span class="string">string</span>
    WeatherApiKey <span class="string">string</span>
    RedisAddress  <span class="string">string</span>
}

<span class="keyword">func</span> <span class="func">LoadConfig</span>() (*Config, <span class="keyword">error</span>) {
    viper.SetConfigFile(<span class="string">"cmd/config.json"</span>)
    viper.AutomaticEnv()
    
    <span class="keyword">if</span> err := viper.ReadInConfig(); err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> <span class="keyword">nil</span>, err
    }
    
    <span class="keyword">var</span> cfg Config
    <span class="keyword">if</span> err := viper.Unmarshal(&cfg); err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> <span class="keyword">nil</span>, err
    }
    
    <span class="keyword">return</span> &cfg, <span class="keyword">nil</span>
}</div>
                    
                    <div class="tip">
                        <strong>Tip:</strong> Get your free API key from <a href="https://www.visualcrossing.com/weather-api" target="_blank">visualcrossing.com</a>
                    </div>
                </div>
            </div>
            
            <!-- Step 3: Basic Server -->
            <div class="step" data-step="3">
                <div class="step-header" onclick="toggleStep(3)">
                    <div class="step-title">
                        <div class="step-num">3</div>
                        <div>
                            <h3>Basic Server</h3>
                            <p>Create HTTP server with one endpoint</p>
                        </div>
                    </div>
                </div>
                <div class="step-content">
                    <div class="info-box">
                        <strong>Goal:</strong> Get a running server that responds to requests
                    </div>
                    
                    <div class="checklist">
                        <div class="check-item">
                            <input type="checkbox" id="step3-1" onchange="updateProgress()">
                            <label for="step3-1">Create main.go entry point</label>
                        </div>
                        <div class="check-item">
                            <input type="checkbox" id="step3-2" onchange="updateProgress()">
                            <label for="step3-2">Create weather handler with hardcoded response</label>
                        </div>
                        <div class="check-item">
                            <input type="checkbox" id="step3-3" onchange="updateProgress()">
                            <label for="step3-3">Test the server works</label>
                        </div>
                    </div>
                    
                    <h4 style="margin-top: 20px;">1. Create <span class="code-block" style="display:inline;padding:2px 6px;">internal/handlers/weather_handler.go</span>:</h4>
                    <div class="code-block"><span class="keyword">package</span> handlers

<span class="keyword">import</span> (
    <span class="string">"net/http"</span>
    <span class="string">"github.com/gin-gonic/gin"</span>
)

<span class="keyword">func</span> <span class="func">GetWeather</span>(c *gin.Context) {
    city := c.Param(<span class="string">"city"</span>)
    
    <span class="comment">// For now, return hardcoded response</span>
    c.JSON(http.StatusOK, gin.H{
        <span class="string">"city"</span>:        city,
        <span class="string">"temperature"</span>: 25.5,
        <span class="string">"condition"</span>:   <span class="string">"Sunny"</span>,
    })
}</div>
                    
                    <h4 style="margin-top: 20px;">2. Create <span class="code-block" style="display:inline;padding:2px 6px;">cmd/main.go</span>:</h4>
                    <div class="code-block"><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"log"</span>
    <span class="string">"github.com/yourname/weather-api/internal/config"</span>
    <span class="string">"github.com/yourname/weather-api/internal/handlers"</span>
    <span class="string">"github.com/gin-gonic/gin"</span>
)

<span class="keyword">func</span> <span class="func">main</span>() {
    cfg, err := config.LoadConfig()
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        log.Fatal(<span class="string">"Failed to load config:"</span>, err)
    }
    
    r := gin.Default()
    r.GET(<span class="string">"/weather/:city"</span>, handlers.GetWeather)
    
    log.Println(<span class="string">"Server starting on"</span>, cfg.ServerPort)
    r.Run(cfg.ServerPort)
}</div>
                    
                    <h4 style="margin-top: 20px;">3. Test it:</h4>
                    <div class="code-block">go run cmd/main.go</div>
                    <p>Then open browser to: <strong>http://localhost:8080/weather/london</strong></p>
                    
                    <div class="tip">
                        <strong>Expected result:</strong> <code>{"city":"london","temperature":25.5,"condition":"Sunny"}</code>
                    </div>
                </div>
            </div>
            
            <!-- Step 4: Redis Cache -->
            <div class="step" data-step="4">
                <div class="step-header" onclick="toggleStep(4)">
                    <div class="step-title">
                        <div class="step-num">4</div>
                        <div>
                            <h3>Redis Cache</h3>
                            <p>Add caching to reduce API calls</p>
                        </div>
                    </div>
                </div>
                <div class="step-content">
                    <div class="info-box">
                        <strong>Goal:</strong> Cache weather data for 12 hours to save API calls
                    </div>
                    
                    <div class="checklist">
                        <div class="check-item">
                            <input type="checkbox" id="step4-1" onchange="updateProgress()">
                            <label for="step4-1">Install Redis on your machine</label>
                        </div>
                        <div class="check-item">
                            <input type="checkbox" id="step4-2" onchange="updateProgress()">
                            <label for="step4-2">Write internal/cache/cache.go</label>
                        </div>
                        <div class="check-item">
                            <input type="checkbox" id="step4-3" onchange="updateProgress()">
                            <label for="step4-3">Update main.go to use cache</label>
                        </div>
                    </div>
                    
                    <h4 style="margin-top: 20px;">1. Install Redis:</h4>
                    <div class="code-block"><span class="comment"># Ubuntu/Debian</span>
sudo apt update
sudo apt install redis-server
sudo systemctl start redis

<span class="comment"># macOS</span>
brew install redis
brew services start redis</div>
                    
                    <h4 style="margin-top: 20px;">2. Create <span class="code-block" style="display:inline;padding:2px 6px;">internal/cache/cache.go</span>:</h4>
                    <div class="code-block"><span class="keyword">package</span> cache

<span class="keyword">import</span> (
    <span class="string">"context"</span>
    <span class="string">"time"</span>
    <span class="string">"github.com/go-redis/redis/v8"</span>
)

<span class="keyword">type</span> Cache <span class="keyword">struct</span> {
    client *redis.Client
}

<span class="keyword">func</span> <span class="func">NewCache</span>(addr <span class="string">string</span>) *Cache {
    client := redis.NewClient(&redis.Options{
        Addr: addr,
    })
    <span class="keyword">return</span> &Cache{client: client}
}

<span class="keyword">func</span> (c *Cache) <span class="func">Get</span>(ctx context.Context, key <span class="string">string</span>) (<span class="string">string</span>, <span class="keyword">error</span>) {
    <span class="keyword">return</span> c.client.Get(ctx, key).Result()
}

<span class="keyword">func</span> (c *Cache) <span class="func">Set</span>(ctx context.Context, key, value <span class="string">string</span>, expiration time.Duration) <span class="keyword">error</span> {
    <span class="keyword">return</span> c.client.Set(ctx, key, value, expiration).Err()
}</div>
                    
                    <h4 style="margin-top: 20px;">3. Update <span class="code-block" style="display:inline;padding:2px 6px;">cmd/main.go</span>:</h4>
                    <div class="code-block"><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"log"</span>
    <span class="string">"github.com/yourname/weather-api/internal/cache"</span>
    <span class="string">"github.com/yourname/weather-api/internal/config"</span>
    <span class="string">"github.com/yourname/weather-api/internal/handlers"</span>
    <span class="string">"github.com/gin-gonic/gin"</span>
)

<span class="keyword">func</span> <span class="func">main</span>() {
    cfg, err := config.LoadConfig()
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        log.Fatal(<span class="string">"Failed to load config:"</span>, err)
    }
    
    redisCache := cache.NewCache(cfg.RedisAddress)
    
    r := gin.Default()
    r.GET(<span class="string">"/weather/:city"</span>, <span class="keyword">func</span>(c *gin.Context) {
        handlers.GetWeather(c, redisCache)
    })
    
    r.Run(cfg.ServerPort)
}</div>
                    
                    <div class="tip">
                        <strong>Test:</strong> First call shows hardcoded data. Refresh and it still shows same data (now cached in Redis!)
                    </div>
                </div>
            </div>
            
            <!-- Step 5: External API -->
            <div class="step" data-step="5">
                <div class="step-header" onclick="toggleStep(5)">
                    <div class="step-title">
                        <div class="step-num">5</div>
                        <div>
                            <h3>External API</h3>
                            <p>Connect to Visual Crossing weather API</p>
                        </div>
                    </div>
                </div>
                <div class="step-content">
                    <div class="info-box">
                        <strong>Goal:</strong> Fetch real weather data from Visual Crossing
                    </div>
                    
                    <div class="checklist">
                        <div class="check-item">
                            <input type="checkbox" id="step5-1" onchange="updateProgress()">
                            <label for="step5-1">Create internal/services/weather_service.go</label>
                        </div>
                        <div class="check-item">
                            <input type="checkbox" id="step5-2" onchange="updateProgress()">
                            <label for="step5-2">Update handlers to use service</label>
                        </div>
                        <div class="check-item">
                            <input type="checkbox" id="step5-3" onchange="updateProgress()">
                            <label for="step5-3">Test with real API</label>
                        </div>
                    </div>
                    
                    <h4 style="margin-top: 20px;">1. Create <span class="code-block" style="display:inline;padding:2px 6px;">internal/services/weather_service.go</span>:</h4>
                    <div class="code-block"><span class="keyword">package</span> services

<span class="keyword">import</span> (
    <span class="string">"context"</span>
    <span class="string">"encoding/json"</span>
    <span class="string">"fmt"</span>
    <span class="string">"io"</span>
    <span class="string">"net/http"</span>
    <span class="string">"time"</span>
    <span class="string">"github.com/yourname/weather-api/internal/cache"</span>
)

<span class="keyword">type</span> WeatherService <span class="keyword">struct</span> {
    apiKey <span class="string">string</span>
    cache  *cache.Cache
}

<span class="keyword">func</span> <span class="func">NewWeatherService</span>(apiKey <span class="string">string</span>, c *cache.Cache) *WeatherService {
    <span class="keyword">return</span> &WeatherService{apiKey: apiKey, cache: c}
}

<span class="keyword">type</span> WeatherResponse <span class="keyword">struct</span> {
    Location    <span class="string">string</span>    <span class="string">`json:"location"`</span>
    Temperature <span class="type">float64</span>   <span class="string">`json:"temperature"`</span>
    Conditions  <span class="string">string</span>    <span class="string">`json:"conditions"`</span>
    Time        <span class="type">time.Time</span> <span class="string">`json:"time"`</span>
}

<span class="keyword">func</span> (s *WeatherService) <span class="func">GetWeather</span>(ctx context.Context, city <span class="string">string</span>) (WeatherResponse, <span class="keyword">error</span>) {
    <span class="comment">// Check cache first</span>
    cacheKey := <span class="string">"weather:"</span> + city
    cached, _ := s.cache.Get(ctx, cacheKey)
    <span class="keyword">if</span> cached != <span class="string">""</span> {
        <span class="keyword">var</span> resp WeatherResponse
        json.Unmarshal([]byte(cached), &resp)
        resp.Time = time.Now()
        <span class="keyword">return</span> resp, <span class="keyword">nil</span>
    }
    
    <span class="comment">// Call Visual Crossing API</span>
    url := fmt.Sprintf(
        <span class="string">"https://weather.visualcrossing.com/VisualCrossingWebServices/rest/services/timeline/%s?unitGroup=metric&key=%s&contentType=json"</span>,
        city, s.apiKey,
    )
    
    resp, err := http.Get(url)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> WeatherResponse{}, fmt.Errorf(<span class="string">"API request failed: %v"</span>, err)
    }
    <span class="keyword">defer</span> resp.Body.Close()
    
    <span class="keyword">if</span> resp.StatusCode != http.StatusOK {
        <span class="keyword">return</span> WeatherResponse{}, fmt.Errorf(<span class="string">"API returned status %d"</span>, resp.StatusCode)
    }
    
    body, _ := io.ReadAll(resp.Body)
    
    <span class="keyword">var</span> apiResp map[string]interface{}
    json.Unmarshal(body, &apiResp)
    
    <span class="keyword">if</span> days, ok := apiResp[<span class="string">"days"</span>].([]interface{}); ok && <span class="keyword">len</span>(days) > 0 {
        day := days[0].(map[string]interface{})
        
        result := WeatherResponse{
            Location:    apiResp[<span class="string">"resolvedAddress"</span>].(string),
            Temperature: day[<span class="string">"temp"</span>].(float64),
            Conditions:  day[<span class="string">"conditions"</span>].(string),
            Time:        time.Now(),
        }
        
        <span class="comment">// Cache for 12 hours</span>
        jsonData, _ := json.Marshal(result)
        s.cache.Set(ctx, cacheKey, string(jsonData), 12*time.Hour)
        
        <span class="keyword">return</span> result, <span class="keyword">nil</span>
    }
    
    <span class="keyword">return</span> WeatherResponse{}, fmt.Errorf(<span class="string">"no weather data found"</span>)
}</div>
                    
                    <h4 style="margin-top: 20px;">2. Update <span class="code-block" style="display:inline;padding:2px 6px;">internal/handlers/weather_handler.go</span>:</h4>
                    <div class="code-block"><span class="keyword">package</span> handlers

<span class="keyword">import</span> (
    <span class="string">"net/http"</span>
    <span class="string">"github.com/yourname/weather-api/internal/services"</span>
    <span class="string">"github.com/gin-gonic/gin"</span>
)

<span class="keyword">type</span> WeatherHandler <span class="keyword">struct</span> {
    service *services.WeatherService
}

<span class="keyword">func</span> <span class="func">NewWeatherHandler</span>(s *services.WeatherService) *WeatherHandler {
    <span class="keyword">return</span> &WeatherHandler{service: s}
}

<span class="keyword">func</span> (h *WeatherHandler) <span class="func">GetWeather</span>(c *gin.Context) {
    city := c.Param(<span class="string">"city"</span>)
    <span class="keyword">if</span> city == <span class="string">""</span> {
        c.JSON(http.StatusBadRequest, gin.H{<span class="string">"error"</span>: <span class="string">"city is required"</span>})
        <span class="keyword">return</span>
    }
    
    weather, err := h.service.GetWeather(c.Request.Context(), city)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        c.JSON(http.StatusInternalServerError, gin.H{<span class="string">"error"</span>: err.Error()})
        <span class="keyword">return</span>
    }
    
    c.JSON(http.StatusOK, weather)
}</div>
                    
                    <h4 style="margin-top: 20px;">3. Update <span class="code-block" style="display:inline;padding:2px 6px;">cmd/main.go</span>:</h4>
                    <div class="code-block"><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"log"</span>
    <span class="string">"github.com/yourname/weather-api/internal/cache"</span>
    <span class="string">"github.com/yourname/weather-api/internal/config"</span>
    <span class="string">"github.com/yourname/weather-api/internal/handlers"</span>
    <span class="string">"github.com/yourname/weather-api/internal/services"</span>
    <span class="string">"github.com/gin-gonic/gin"</span>
)

<span class="keyword">func</span> <span class="func">main</span>() {
    cfg, err := config.LoadConfig()
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        log.Fatal(<span class="string">"Failed to load config:"</span>, err)
    }
    
    redisCache := cache.NewCache(cfg.RedisAddress)
    weatherService := services.NewWeatherService(cfg.WeatherApiKey, redisCache)
    weatherHandler := handlers.NewWeatherHandler(weatherService)
    
    r := gin.Default()
    r.GET(<span class="string">"/weather/:city"</span>, weatherHandler.GetWeather)
    
    log.Println(<span class="string">"Server starting on"</span>, cfg.ServerPort)
    r.Run(cfg.ServerPort)
}</div>
                    
                    <div class="tip">
                        <strong>Test:</strong> Visit http://localhost:8080/weather/newyork - you should see REAL weather data!
                    </div>
                </div>
            </div>
            
            <!-- Step 6: Production -->
            <div class="step" data-step="6">
                <div class="step-header" onclick="toggleStep(6)">
                    <div class="step-title">
                        <div class="step-num">6</div>
                        <div>
                            <h3>Production Polish</h3>
                            <p>Rate limiting and Docker deployment</p>
                        </div>
                    </div>
                </div>
                <div class="step-content">
                    <div class="info-box">
                        <strong>Goal:</strong> Add rate limiting and Docker for production deployment
                    </div>
                    
                    <div class="checklist">
                        <div class="check-item">
                            <input type="checkbox" id="step6-1" onchange="updateProgress()">
                            <label for="step6-1">Add rate limiting middleware</label>
                        </div>
                        <div class="check-item">
                            <input type="checkbox" id="step6-2" onchange="updateProgress()">
                            <label for="step6-2">Create Dockerfile</label>
                        </div>
                        <div class="check-item">
                            <input type="checkbox" id="step6-3" onchange="updateProgress()">
                            <label for="step6-3">Create docker-compose.yml</label>
                        </div>
                    </div>
                    
                    <h4 style="margin-top: 20px;">1. Create <span class="code-block" style="display:inline;padding:2px 6px;">internal/middleware/rate_limiter.go</span>:</h4>
                    <div class="code-block"><span class="keyword">package</span> middleware

<span class="keyword">import</span> (
    <span class="string">"net/http"</span>
    <span class="string">"github.com/didip/tollbooth"</span>
    <span class="string">"github.com/gin-gonic/gin"</span>
)

<span class="keyword">func</span> <span class="func">RateLimit</span>() gin.HandlerFunc {
    limiter := tollbooth.NewLimiter(1, <span class="keyword">nil</span>) <span class="comment">// 1 request per second</span>
    <span class="keyword">return</span> <span class="keyword">func</span>(c *gin.Context) {
        err := tollbooth.LimitByRequest(limiter, c.Writer, c.Request)
        <span class="keyword">if</span> err != <span class="keyword">nil</span> {
            c.AbortWithStatusJSON(http.StatusTooManyRequests, gin.H{
                <span class="string">"error"</span>: <span class="string">"Too many requests"</span>,
            })
            <span class="keyword">return</span>
        }
        c.Next()
    }
}</div>
                    
                    <h4 style="margin-top: 20px;">2. Update main.go with middleware:</h4>
                    <div class="code-block">r := gin.Default()
r.Use(middleware.RateLimit())
r.GET(<span class="string">"/weather/:city"</span>, weatherHandler.GetWeather)</div>
                    
                    <h4 style="margin-top: 20px;">3. Create <span class="code-block" style="display:inline;padding:2px 6px;">Dockerfile</span>:</h4>
                    <div class="code-block"><span class="comment"># Build stage</span>
FROM golang:1.22-alpine AS builder
WORKDIR /app
COPY go.mod go.sum ./
RUN go mod download
COPY . .
RUN go build -o weather-api ./cmd/main.go

<span class="comment"># Run stage</span>
FROM alpine:latest
WORKDIR /app
COPY --from=builder /app/weather-api .
COPY --from=builder /app/cmd/config.json .
EXPOSE 8080
CMD [<span class="string">"./weather-api"</span>]</div>
                    
                    <h4 style="margin-top: 20px;">4. Create <span class="code-block" style="display:inline;padding:2px 6px;">docker-compose.yml</span>:</h4>
                    <div class="code-block">version: <span class="string">'3'</span>
services:
  weather-api:
    build: .
    ports:
      - <span class="string">"8080:8080"</span>
    environment:
      - WEATHER_API_KEY=${WEATHER_API_KEY}
      - REDIS_ADDRESS=redis:6379
    depends_on:
      - redis

  redis:
    image: redis:alpine
    ports:
      - <span class="string">"6379:6379"</span>

volumes:
  redis-data:</div>
                    
                    <h4 style="margin-top: 20px;">5. Update cmd/config.json for Docker:</h4>
                    <div class="code-block">{
    <span class="string">"serverPort"</span>: <span class="string">":8080"</span>,
    <span class="string">"weatherApiKey"</span>: <span class="string">""</span>,
    <span class="string">"redisAddress"</span>: <span class="string">"redis:6379"</span>
}</div>
                    
                    <h4 style="margin-top: 20px;">6. Run with Docker:</h4>
                    <div class="code-block">docker-compose build
docker-compose up</div>
                    
                    <div class="tip">
                        <strong>You're done!</strong> Your production-ready Weather API is now running with:<br>
                        ✓ Real weather data from Visual Crossing<br>
                        ✓ 12-hour caching with Redis<br>
                        ✓ Rate limiting (1 req/sec)<br>
                        ✓ Docker deployment<br>
                        ✓ Environment variable configuration
                    </div>
                </div>
            </div>
        </div>
        
        <div class="nav">
            <button class="reset" onclick="resetProgress()">Reset Progress</button>
        </div>
    </div>

    <script>
        const steps = 6;
        
        function toggleStep(num) {
            document.querySelector(`.step[data-step="${num}"]`).classList.toggle('active');
        }
        
        function updateProgress() {
            let total = 0, completed = 0;
            document.querySelectorAll('input[type="checkbox"]').forEach(cb => {
                total++;
                if (cb.checked) completed++;
            });
            
            const percent = Math.round((completed / total) * 100);
            document.getElementById('progress').style.width = percent + '%';
            document.getElementById('progressText').textContent = percent + '% Complete';
            
            for (let i = 1; i <= steps; i++) {
                const stepInputs = document.querySelectorAll(`.step[data-step="${i}"] input[type="checkbox"]`);
                const allChecked = Array.from(stepInputs).every(cb => cb.checked);
                document.querySelector(`.step[data-step="${i}"]`).classList.toggle('completed', allChecked);
            }
            
            localStorage.setItem('weatherApiProgress', JSON.stringify({
                checkboxes: Array.from(document.querySelectorAll('input[type="checkbox"]')).map(cb => cb.checked)
            }));
        }
        
        function resetProgress() {
            if (confirm('Reset all progress?')) {
                document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
                updateProgress();
            }
        }
        
        window.addEventListener('DOMContentLoaded', () => {
            const saved = localStorage.getItem('weatherApiProgress');
            if (saved) {
                const data = JSON.parse(saved);
                document.querySelectorAll('input[type="checkbox"]').forEach((cb, i) => {
                    cb.checked = data.checkboxes[i];
                });
            }
            updateProgress();
        });
    </script>
</body>
</html>
